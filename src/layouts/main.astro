---
import "../styles/global.css";
import { getImage } from "astro:assets";
import { SplashCursor } from "@/components/ui/splash-cursor";
import Analytics from "@vercel/analytics/astro";
import SpeedInsights from "@vercel/speed-insights/astro";
import LogoImg from "../../public/logo.png";
import { getLangFromUrl } from "../i18n/utils";
import { Navigation } from "./Navigation.tsx";
import Footer from "./footer.astro";

const { hasNav } = Astro.props;
const lang = getLangFromUrl(Astro.url);

const optimizedImage = await getImage({
	src: LogoImg,
	width: 64,
	format: "webp", // Convert to webp for better compression
});
---
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width"/>
    <link rel="icon" href="/favico.ico"/>
    <link rel="image_src" href="/logo_small.png">
    <title>WyroTech üåç by Andreas Wyrobek</title>
    <!-- SEO metadata -->
    <meta name="description"
          content="Andreas Wyrobek - Principal Software Engineer & UX/UI Lead  | Angular & UX Specialist"/>
    <meta name="keywords" content="full-stack developer, angular specialist, ux design, bavaria"/>
    <meta property="og:title" content="WyroTech by Andreas Wyrobek"/>
    <meta property="og:description" content="Principal Software Engineer & UX/UI Lead"/>
    <meta property="og:type" content="website"/>
    <link rel="manifest" href="/site.webmanifest">

    <link rel="preload" href={optimizedImage.src} as="image"/>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Syne:wght@400..800&display=swap"
          rel="stylesheet">

    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="WyroTech by Andreas Wyrobek">
    <meta name="twitter:description"
          content="Principal Software Engineer & UX/UI Lead | Angular & UX Specialist">
    <meta name="twitter:image" content="https://wyro.tech/logo_small.png">

    <link rel="canonical" href={"https://wyro.tech/" + Astro.url.pathname}>

    <meta name="author" content="Andreas Wyrobek">
    <meta name="robots" content="index, follow">
    <meta name="language" content={lang === "de" ? "German" : "English"}>

    <meta property="og:image" content="https://wyro.tech/logo_small.png">
    <meta property="og:image:width" content="915">
    <meta property="og:image:height" content="895">
    <meta property="og:url" content="https://wyro.tech">
    <meta property="og:locale" content={lang === "de" ? "de_DE" : "en_US"}>
</head>
<body>
<SpeedInsights/>
<Analytics/>
<SplashCursor client:only="react"/>
<div id="body">
    {hasNav &&
            <Navigation client:only="react" imageUrl={optimizedImage.src}/>}
    <div>
        <slot/>
    </div>
    {hasNav && <Footer/>}
</div>

{hasNav &&
        <div id="loading-screen"
             class="loading-screen fixed inset-0 z-[999999] bg-black transition-opacity duration-1000">
            <div class="fixed inset-0 flex justify-center items-center">
                <div class="flex items-center gap-px">
                    <img
                            src={optimizedImage.src}
                            alt="logo"
                            width="56"
                            height="56"
                            class="mr-1"
                            loading="lazy"
                    />
                    <span class="font-extrabold! text-6xl! text-white!">Wyro</span>
                    <span class="font-thin! text-6xl! text-white!">Tech</span>
                </div>
            </div>
        </div>
}

<script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Person",
        "name": "WyroTech by Andreas Wyrobek",
        "logo": "https://wyro.tech/logo_small.png",
        "url": "https://wyro.tech",
        "jobTitle": "Principal Software Engineer & UX/UI Lead",
        "nationality": "German",
        "worksFor": {
            "@type": "Organization",
            "name": "WyroTech"
        },
        "skills": [
            "Angular",
            "UX Design",
            "Principal Software Engineer",
            "UX/UI Lead"
        ]
    }
</script>
</body>
</html>
